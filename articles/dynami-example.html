<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DyNAM-i: an example script • goldfish</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DyNAM-i: an example script">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">goldfish</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">goldfish effects</li>
    <li>
      <a href="../articles/goldfishEffects.html">goldfish Effects</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">How to start</li>
    <li>
      <a href="../articles/teaching1.html">DyNAM: How to start</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">choice coordination</li>
    <li>
      <a href="../articles/teaching2.html">The Coordination Model and Extensions</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">DyNAM-i</li>
    <li>
      <a href="../articles/dynami-example.html">DyNAM-i: an example script</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stocnet/goldfish" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>DyNAM-i: an example script</h1>
            <h3 data-toc-skip class="subtitle">Dynamic Network Actor
Models for face-to-face interaction data</h3>
                        <h4 data-toc-skip class="author">Marion
Hoffman</h4>
            
            <h4 data-toc-skip class="date">2022-08-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stocnet/goldfish/blob/develop/vignettes/dynami-example.Rmd" class="external-link"><code>vignettes/dynami-example.Rmd</code></a></small>
      <div class="hidden name"><code>dynami-example.Rmd</code></div>

    </div>

    
    
<p>Example script analyzing the RFID validity study data (Elmer et al,
2019) with the DyNAM-i model of the <code>goldfish</code> package. Data
received from:</p>
<blockquote>
<p>Elmer, T., Chaitanya, K., Purwar, P., &amp; Stadtfeld, C. (2019). The
validity of RFID badges measuring face-to-face interactions. Behavior
research methods, 51(5), 2120-2138.</p>
</blockquote>
<p>Analyses inspired from:</p>
<blockquote>
<p>Hoffman, M., Block, P., Elmer, T., &amp; Stadtfeld, C. (2020). A
model for the dynamics of face-to-face interactions in social groups.
Network Science, 8(S1), S4-S25.</p>
</blockquote>
<div class="section level2">
<h2 id="step-0-load-package-and-data">Step 0: Load package and data<a class="anchor" aria-label="anchor" href="#step-0-load-package-and-data"></a>
</h2>
<p>First, we load the <code>goldfish</code> package and load the data. .
You can find out more about this dataset and its format by callings its
documentation.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stocnet.github.io/goldfish/">goldfish</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"RFID_Validity_Study"</span><span class="op">)</span></span>
<span><span class="co">#?RFID_Validity_Study</span></span></code></pre></div>
<p>The <code>participants</code> object contains the nodeset of actors
interacting together. The available attributes are their age, their
gender, their organizational unit (group), and their seniority
level:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">participants</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   actor  label present age gender group level</span></span>
<span><span class="co">## 1     1 Actor1    TRUE  35      0     1     4</span></span>
<span><span class="co">## 2     2 Actor2    TRUE  34      0     2     3</span></span>
<span><span class="co">## 3     3 Actor3    TRUE  25      1     1     1</span></span>
<span><span class="co">## 4     4 Actor4    TRUE  26      0     1     2</span></span>
<span><span class="co">## 5     5 Actor5    TRUE  26      0     1     1</span></span>
<span><span class="co">## 6     6 Actor6    TRUE  31      1     3     3</span></span></code></pre>
<p>The <code>rfid</code> object contains the list of dyadic interactions
collected via RFID badges. Each interaction is characterized by two
actors (<code>NodeA</code> and <code>NodeB</code>) and two time points
(<code>Start</code> and <code>End</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rfid</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   NodeA NodeB      Start        End</span></span>
<span><span class="co">## 1     3     4 1491329893 1491329930</span></span>
<span><span class="co">## 2     1    11 1491329894 1491329926</span></span>
<span><span class="co">## 3    10     8 1491329894 1491329904</span></span>
<span><span class="co">## 4    10     4 1491329895 1491329911</span></span>
<span><span class="co">## 5    10     5 1491329895 1491329924</span></span>
<span><span class="co">## 6     3     5 1491329902 1491329913</span></span></code></pre>
<p>The <code>video</code> object contains the list of dyadic
interactions collected via video recordings and has the same format as
the <code>rfid</code> object. We know that these measures should be more
reliable, so we will work with those data in this script!</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">video</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    NodeA NodeB      Start        End</span></span>
<span><span class="co">## 13     5     8 1491329893 1491329984</span></span>
<span><span class="co">## 14     7     1 1491329893 1491329984</span></span>
<span><span class="co">## 18     1    11 1491329893 1491329984</span></span>
<span><span class="co">## 19     1     6 1491329893 1491329984</span></span>
<span><span class="co">## 42     7     6 1491329893 1491330372</span></span>
<span><span class="co">## 45    11     6 1491329893 1491330372</span></span></code></pre>
<p>Finally, the <code>known.before</code> matrix indicates which actors
knew each other before the event.</p>
<div class="section level4">
<h4 id="step-1-create-groups-and-interaction-events">Step 1: Create groups and interaction events<a class="anchor" aria-label="anchor" href="#step-1-create-groups-and-interaction-events"></a>
</h4>
<p>Before specifying the model, we need to set the data in the right
format for DyNAM-i: We had a list of dyadic interactions, but DyNAM-i is
specifically meant for group interactions. More specifically, the model
is designed for events of actors joining or leavin interaction groups.
We can use this function to create these group events (please note we
need to use the right labels in the dataframe: <code>NodeA</code>,
<code>NodeB</code>,<code>Start</code>, and <code>End</code>):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#?make_groups_interaction</span></span>
<span><span class="va">prepdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_groups_interaction.html">make_groups_interaction</a></span><span class="op">(</span><span class="va">video</span>, <span class="va">participants</span>,</span>
<span>                                    seed_randomization <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>This functions to creates 5 objects: 1. <code>groups</code>: a
goldfish nodeset containing the interaction groups (initially there are
as many groups as actors and they are all present, meaning
available)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="va">prepdata</span><span class="op">$</span><span class="va">groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    label present</span></span>
<span><span class="co">## 1 Group1    TRUE</span></span>
<span><span class="co">## 2 Group2    TRUE</span></span>
<span><span class="co">## 3 Group3    TRUE</span></span>
<span><span class="co">## 4 Group4    TRUE</span></span>
<span><span class="co">## 5 Group5    TRUE</span></span>
<span><span class="co">## 6 Group6    TRUE</span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<code>dependent.events</code>: goldfish events specifying the events
that we want to model, when an actor (in the dataframe, the
<code>sender</code> column) joins or leaves (<code>increment</code> = 1
or -1) a group (<code>receiver</code>) at a particular point in time
(<code>time</code>)</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dependentEvents</span> <span class="op">&lt;-</span> <span class="va">prepdata</span><span class="op">$</span><span class="va">dependent.events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dependentEvents</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         time  sender receiver increment</span></span>
<span><span class="co">## 1 1491329893  Actor4   Group3         1</span></span>
<span><span class="co">## 2 1491329893  Actor2   Group9         1</span></span>
<span><span class="co">## 3 1491329893  Actor7   Group6         1</span></span>
<span><span class="co">## 4 1491329893  Actor1   Group6         1</span></span>
<span><span class="co">## 5 1491329893 Actor11   Group6         1</span></span>
<span><span class="co">## 6 1491329893  Actor8   Group5         1</span></span></code></pre>
<ol start="3" style="list-style-type: decimal">
<li>
<code>exogenous.events</code>: goldfish events specifying the events
that need to happen but are not modeled (for example, when an actor
leaves a group, a dependent event is created for this leaving but an
exogenous event is also created because the actor “joins” a new group,
its own isolated group)</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exogenousEvents</span> <span class="op">&lt;-</span> <span class="va">prepdata</span><span class="op">$</span><span class="va">exogenous.events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exogenousEvents</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         time  sender receiver increment</span></span>
<span><span class="co">## 1 1491329893  Actor4   Group4        -1</span></span>
<span><span class="co">## 2 1491329893  Actor2   Group2        -1</span></span>
<span><span class="co">## 3 1491329893  Actor7   Group7        -1</span></span>
<span><span class="co">## 4 1491329893  Actor1   Group1        -1</span></span>
<span><span class="co">## 5 1491329893 Actor11  Group11        -1</span></span>
<span><span class="co">## 6 1491329893  Actor8   Group8        -1</span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<code>interaction.updates</code>: goldfish events that are used to
update the number of past interactions between participants:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactionUpdates</span> <span class="op">&lt;-</span> <span class="va">prepdata</span><span class="op">$</span><span class="va">interaction.updates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">interactionUpdates</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         time  sender receiver increment</span></span>
<span><span class="co">## 1 1491329893  Actor4   Actor3         1</span></span>
<span><span class="co">## 2 1491329893  Actor2   Actor9         1</span></span>
<span><span class="co">## 3 1491329893  Actor7   Actor6         1</span></span>
<span><span class="co">## 4 1491329893  Actor1   Actor6         1</span></span>
<span><span class="co">## 5 1491329893  Actor1   Actor7         1</span></span>
<span><span class="co">## 6 1491329893 Actor11   Actor1         1</span></span></code></pre>
<ol start="5" style="list-style-type: decimal">
<li>
<code>opportunities</code>: list containing the interaction groups
available at each decision time (this will vary when groups are being
joined or left)</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opportunities</span> <span class="op">&lt;-</span> <span class="va">prepdata</span><span class="op">$</span><span class="va">opportunities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">opportunities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##  [1]  1  2  3  5  6  7  8  9 10 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">## [1]  1  9  3  5  6  7  8 10 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">## [1]  1  9  3  5  6  8 10 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">## [1]  6  9  3  5  8 10 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[6]]</span></span>
<span><span class="co">## [1]  6  9  3  5  8 10</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-2-set-up-goldfish-objects">Step 2: Set up goldfish objects<a class="anchor" aria-label="anchor" href="#step-2-set-up-goldfish-objects"></a>
</h4>
<p>Now that we have all the data we need, we need to define the link
between our objects in a way that goldfish understands what is going
on.</p>
<p>First, we define the first mode nodeset, the actors:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># goldfish requires character names</span></span>
<span><span class="va">participants</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">participants</span><span class="op">$</span><span class="va">label</span><span class="op">)</span></span>
<span><span class="va">actors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nodes.html">make_nodes</a></span><span class="op">(</span><span class="va">participants</span><span class="op">)</span></span></code></pre></div>
<p>Then we define the second mode nodeset, the groups:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nodes.html">make_nodes</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span></code></pre></div>
<p>Then we create the dynamic interaction network between the actors and
the groups, updated by the previously created events in
<code>dependent.events</code> and <code>exogenous.events</code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initNetwork</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">actors</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># goldfish check that row/column names agree with the nodes data frame labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">initNetwork</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">label</span>, <span class="va">groups</span><span class="op">$</span><span class="va">label</span><span class="op">)</span></span>
<span><span class="va">networkInteractions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_network.html">make_network</a></span><span class="op">(</span></span>
<span>  matrix <span class="op">=</span> <span class="va">initNetwork</span>, nodes <span class="op">=</span> <span class="va">actors</span>, nodes2 <span class="op">=</span> <span class="va">groups</span>, directed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">networkInteractions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link_events.html">link_events</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">networkInteractions</span>, change_events <span class="op">=</span> <span class="va">dependentEvents</span>,</span>
<span>  nodes <span class="op">=</span> <span class="va">actors</span>, nodes2 <span class="op">=</span> <span class="va">groups</span></span>
<span><span class="op">)</span></span>
<span><span class="va">networkInteractions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link_events.html">link_events</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">networkInteractions</span>, change_events <span class="op">=</span> <span class="va">exogenousEvents</span>,</span>
<span>  nodes <span class="op">=</span> <span class="va">actors</span>, nodes2 <span class="op">=</span> <span class="va">groups</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then we create the dynamic network between the actors that records
past interactions, updated by the previously created events in
<code>interaction.updates</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">networkPast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_network.html">make_network</a></span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">actors</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">networkPast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link_events.html">link_events</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">networkPast</span>, change_events <span class="op">=</span> <span class="va">interactionUpdates</span>, nodes <span class="op">=</span> <span class="va">actors</span></span>
<span><span class="op">)</span> <span class="co"># don't worry about the warnings</span></span></code></pre></div>
<p>In the next step, we define the events that we want to model:
<code>dependentEvents</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dependentEvents</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_dependent_events.html">make_dependent_events</a></span><span class="op">(</span></span>
<span>  events <span class="op">=</span> <span class="va">dependentEvents</span>, nodes <span class="op">=</span> <span class="va">actors</span>,</span>
<span>  nodes2 <span class="op">=</span> <span class="va">groups</span>, default_network <span class="op">=</span> <span class="va">networkInteractions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As a final step, we define a goldfish data object that contains all
the information needed to estimate the model. So, it is a container for
the dependent events, the networks, and the nodes containing all the
information of the dependent events and any dyadic or nodal covariate
used as explanatory variables in the model.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfidData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_data.html">make_data</a></span><span class="op">(</span></span>
<span>  <span class="va">dependentEvents</span>, <span class="va">networkInteractions</span>, <span class="va">networkPast</span>,</span>
<span>  <span class="va">interactionUpdates</span>, <span class="va">exogenousEvents</span>, <span class="va">known.before</span>, <span class="va">opportunities</span>,</span>
<span>  <span class="va">actors</span>, <span class="va">groups</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rfidData</span></span></code></pre></div>
<pre><code><span><span class="co">## Goldfish Data Environment</span></span>
<span><span class="co">## =========================</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --- Nodesets ---</span></span>
<span><span class="co">##         n attributes linked_events</span></span>
<span><span class="co">## actors 11          6              </span></span>
<span><span class="co">## groups 11          1              </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --- Networks ---</span></span>
<span><span class="co">##                     dimensions        nodeset                    linked_events directed</span></span>
<span><span class="co">## networkInteractions      11x11 actors, groups dependentEvents, exogenousEvents     TRUE</span></span>
<span><span class="co">## networkPast              11x11         actors               interactionUpdates    FALSE</span></span>
<span><span class="co">##                     two_mode</span></span>
<span><span class="co">## networkInteractions     TRUE</span></span>
<span><span class="co">## networkPast            FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --- Events Data Frames ---</span></span>
<span><span class="co">##                    n_events object_type update_mode</span></span>
<span><span class="co">## dependentEvents         234      dyadic   increment</span></span>
<span><span class="co">## exogenousEvents         234      dyadic   increment</span></span>
<span><span class="co">## interactionUpdates      289      dyadic   increment</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## --- Other Objects ---</span></span>
<span><span class="co">##                class length</span></span>
<span><span class="co">## known.before  matrix    121</span></span>
<span><span class="co">## opportunities   list    123</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-4-estimate-a-model-with-attribute-effects">Step 4: Estimate a model with attribute effects<a class="anchor" aria-label="anchor" href="#step-4-estimate-a-model-with-attribute-effects"></a>
</h4>
<p>Let us define some models we could estimate (we try not to put too
many effects because we have little data).</p>
<p>We first have a model only with effects related to individual
attributes (M1).</p>
<p>For the rate, we have the following effects:</p>
<ol style="list-style-type: decimal">
<li>general intercept (joining and leaving events) + dummy interaction
for the intercept of joining events specifically</li>
<li>ego age (joining): tendency for older individuals to join groups
faster</li>
<li>ego age (leaving): tendency for older individuals to leave groups
faster</li>
<li>diff age (leaving): tendency for individuals to leave groups faster
if the average sum of age difference to the group are high</li>
<li>diff level (leaving): tendency for individuals to leave groups
faster if the average sum of level difference to the group are high</li>
<li>same gender (leaving): tendency for individuals to leave groups
faster if the proportion of same gender in the group is high</li>
<li>same group (leaving): tendency for individuals to leave groups
faster if the proportion of same group in the group is high</li>
<li>tie known before (leaving): tendency for individuals to leave groups
faster if the proportion of previous friends in the group is high</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulaRateM1</span> <span class="op">&lt;-</span> <span class="va">dependentEvents</span> <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span></span>
<span>  <span class="fu">intercept</span><span class="op">(</span><span class="va">networkInteractions</span>, joining <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ego</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"centered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ego</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"centered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">level</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">gender</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">group</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tie</span><span class="op">(</span><span class="va">known.before</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span></span></code></pre></div>
<p>and for the choice model:</p>
<ol start="9" style="list-style-type: decimal">
<li>diff age: tendency for individuals to join groups if the average sum
of age difference to the group are high</li>
<li>diff level: tendency for individuals to join groups if the average
sum of level difference to the group are high</li>
<li>same gender: tendency for individuals to join groups if the
proportion of same gender in the group is high</li>
<li>same group: tendency for individuals to join groups if the
proportion of same group in the group is high</li>
<li>tie known before: tendency for individuals to join groups if the
proportion of previous friends in the group is high</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulaChoiceM1</span> <span class="op">&lt;-</span> <span class="va">dependentEvents</span> <span class="op">~</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">level</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">gender</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">group</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tie</span><span class="op">(</span><span class="va">known.before</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span></span></code></pre></div>
<p>Note that effects in the choice model can mirror the ones in the
leaving model: The first model explains who people want to join (or not
join), the second explains who people want to leave (or stay with).</p>
<p>Now let us run goldfish estimation!</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estRateM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate_dynami</a></span><span class="op">(</span></span>
<span>  <span class="va">formulaRateM1</span>,</span>
<span>  sub_model <span class="op">=</span> <span class="st">"rate"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">rfidData</span>,</span>
<span>  control_estimation <span class="op">=</span> <span class="fu"><a href="../reference/set_estimation_opt.html">set_estimation_opt</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span>                      </span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estRateM1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## estimate_dynami(x = dependentEvents ~ 1 + intercept(networkInteractions, </span></span>
<span><span class="co">##     joining = 1) + ego(actors$age, joining = 1, subType = "centered") + </span></span>
<span><span class="co">##     ego(actors$age, joining = -1, subType = "centered") + diff(actors$age, </span></span>
<span><span class="co">##     joining = -1, subType = "averaged_sum") + diff(actors$level, </span></span>
<span><span class="co">##     joining = -1, subType = "averaged_sum") + same(actors$gender, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion") + same(actors$group, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion") + tie(known.before, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion"), sub_model = "rate", </span></span>
<span><span class="co">##     data = rfidData, control_estimation = set_estimation_opt(engine = "default"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Effects details:</span></span>
<span><span class="co">##           Object                joining subType         </span></span>
<span><span class="co">## Intercept ""                    ""      ""              </span></span>
<span><span class="co">## intercept "networkInteractions" "1"     ""              </span></span>
<span><span class="co">## ego       "actors$age"          "1"     ""centered""    </span></span>
<span><span class="co">## ego       "actors$age"          "-1"    ""centered""    </span></span>
<span><span class="co">## diff      "actors$age"          "-1"    ""averaged_sum""</span></span>
<span><span class="co">## diff      "actors$level"        "-1"    ""averaged_sum""</span></span>
<span><span class="co">## same      "actors$gender"       "-1"    ""proportion""  </span></span>
<span><span class="co">## same      "actors$group"        "-1"    ""proportion""  </span></span>
<span><span class="co">## tie       "known.before"        "-1"    ""proportion""  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##            Estimate Std. Error  z-value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## Intercept -5.942916   0.322237 -18.4427 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## intercept  2.509660   0.334344   7.5062 6.084e-14 ***</span></span>
<span><span class="co">## ego        0.061687   0.024706   2.4968   0.01253 *  </span></span>
<span><span class="co">## ego        0.027958   0.035570   0.7860   0.43188    </span></span>
<span><span class="co">## diff      -0.163643   0.069175  -2.3656   0.01800 *  </span></span>
<span><span class="co">## diff       0.361468   0.226675   1.5947   0.11079    </span></span>
<span><span class="co">## same       0.027282   0.254374   0.1073   0.91459    </span></span>
<span><span class="co">## same       0.508497   0.371577   1.3685   0.17116    </span></span>
<span><span class="co">## tie       -0.156303   0.346267  -0.4514   0.65170    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Converged with max abs. score of 0.00012 </span></span>
<span><span class="co">##   Log-Likelihood: -1306.3</span></span>
<span><span class="co">##   AIC:  2630.6 </span></span>
<span><span class="co">##   AICc: 2631.4 </span></span>
<span><span class="co">##   BIC:  2661.7 </span></span>
<span><span class="co">##   model: "DyNAMi" subModel: "rate"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estChoiceM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate_dynami</a></span><span class="op">(</span></span>
<span>  <span class="va">formulaChoiceM1</span>,</span>
<span>  sub_model <span class="op">=</span> <span class="st">"choice"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">rfidData</span>,</span>
<span>  control_preprocessing <span class="op">=</span></span>
<span>    <span class="fu"><a href="../reference/set_preprocessing_opt.html">set_preprocessing_opt</a></span><span class="op">(</span>opportunities_list <span class="op">=</span> <span class="va">opportunities</span><span class="op">)</span>,</span>
<span>  control_estimation <span class="op">=</span> <span class="fu"><a href="../reference/set_estimation_opt.html">set_estimation_opt</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estChoiceM1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## estimate_dynami(x = dependentEvents ~ diff(actors$age, subType = "averaged_sum") + </span></span>
<span><span class="co">##     diff(actors$level, subType = "averaged_sum") + same(actors$gender, </span></span>
<span><span class="co">##     subType = "proportion") + same(actors$group, subType = "proportion") + </span></span>
<span><span class="co">##     tie(known.before, subType = "proportion"), sub_model = "choice", </span></span>
<span><span class="co">##     data = rfidData, control_estimation = set_estimation_opt(engine = "default"), </span></span>
<span><span class="co">##     control_preprocessing = set_preprocessing_opt(opportunities_list = opportunities))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Effects details:</span></span>
<span><span class="co">##      Object          subType         </span></span>
<span><span class="co">## diff "actors$age"    ""averaged_sum""</span></span>
<span><span class="co">## diff "actors$level"  ""averaged_sum""</span></span>
<span><span class="co">## same "actors$gender" ""proportion""  </span></span>
<span><span class="co">## same "actors$group"  ""proportion""  </span></span>
<span><span class="co">## tie  "known.before"  ""proportion""  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##       Estimate Std. Error z-value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## diff -0.107578   0.067179 -1.6014 0.1092943    </span></span>
<span><span class="co">## diff  0.262945   0.225568  1.1657 0.2437353    </span></span>
<span><span class="co">## same  0.292121   0.298317  0.9792 0.3274665    </span></span>
<span><span class="co">## same  0.024975   0.384103  0.0650 0.9481565    </span></span>
<span><span class="co">## tie   1.316141   0.378545  3.4768 0.0005074 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Converged with max abs. score of 0.00026 </span></span>
<span><span class="co">##   Log-Likelihood: -195.16</span></span>
<span><span class="co">##   AIC:  400.32 </span></span>
<span><span class="co">##   AICc: 400.84 </span></span>
<span><span class="co">##   BIC:  414.39 </span></span>
<span><span class="co">##   model: "DyNAMi" subModel: "choice"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-5-estimate-a-model-with-structural-and-time-effects">Step 5: Estimate a model with structural and time effects<a class="anchor" aria-label="anchor" href="#step-5-estimate-a-model-with-structural-and-time-effects"></a>
</h4>
<p>Now let’s add effects related to group sizes and past interactions.
We add to the rate model the effects of:</p>
<ol style="list-style-type: decimal">
<li>size (leaving): tendency for individuals to leave large groups
faster</li>
<li>egopop (joining): tendency for individuals who had more interactions
in the past to join groups faster</li>
<li>egopop (leaving): tendency for individuals who had more interactions
in the past to leave groups faster</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulaRateM2</span> <span class="op">&lt;-</span> <span class="va">dependentEvents</span> <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span></span>
<span>  <span class="fu">intercept</span><span class="op">(</span><span class="va">networkInteractions</span>, joining <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ego</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"centered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ego</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"centered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">level</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">gender</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">group</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tie</span><span class="op">(</span><span class="va">known.before</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">size</span><span class="op">(</span><span class="va">networkInteractions</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">egopop</span><span class="op">(</span><span class="va">networkPast</span>, joining <span class="op">=</span> <span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">egopop</span><span class="op">(</span><span class="va">networkPast</span>, joining <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, subType <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span></span></code></pre></div>
<p>We add to the choice model:</p>
<ol style="list-style-type: decimal">
<li>size: tendency for individuals to join large groups</li>
<li>alterpop: tendency for individuals to join groups with individuals
who had more interactions in the past</li>
<li>inertia, window = 60s: tendency for individuals to join groups with
a high average number of previous interactions with the group members
within the last minute</li>
<li>inertia, window = 300s: same as above, for 5 minutes</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulaChoiceM2</span> <span class="op">&lt;-</span> <span class="va">dependentEvents</span> <span class="op">~</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">level</span>, subType <span class="op">=</span> <span class="st">"averaged_sum"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">gender</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">same</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">group</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">alter</span><span class="op">(</span><span class="va">actors</span><span class="op">$</span><span class="va">age</span>, subType <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tie</span><span class="op">(</span><span class="va">known.before</span>, subType <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">size</span><span class="op">(</span><span class="va">networkInteractions</span>, subType <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">alterpop</span><span class="op">(</span><span class="va">networkPast</span>, subType <span class="op">=</span> <span class="st">"mean_normalized"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">inertia</span><span class="op">(</span><span class="va">networkPast</span>, window <span class="op">=</span> <span class="fl">60</span>, subType <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">inertia</span><span class="op">(</span><span class="va">networkPast</span>, window <span class="op">=</span> <span class="fl">300</span>, subType <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p>One can note that we have normalized (using the option
<code>subType="mean"</code>) the effects related to previous
interactions, because we want to avoid time heterogeneity issues (in the
beginning no interaction has happened, at the end, a lot happened).</p>
<p>All effects can have different subTypes, please look at the goldfish
documentation to learn more.</p>
<p>Now we can run again</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estRateM2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate_dynami</a></span><span class="op">(</span></span>
<span>  <span class="va">formulaRateM2</span>,</span>
<span>  sub_model <span class="op">=</span> <span class="st">"rate"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">rfidData</span>,</span>
<span>  control_estimation <span class="op">=</span> <span class="fu"><a href="../reference/set_estimation_opt.html">set_estimation_opt</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estRateM2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## estimate_dynami(x = dependentEvents ~ 1 + intercept(networkInteractions, </span></span>
<span><span class="co">##     joining = 1) + ego(actors$age, joining = 1, subType = "centered") + </span></span>
<span><span class="co">##     ego(actors$age, joining = -1, subType = "centered") + diff(actors$age, </span></span>
<span><span class="co">##     joining = -1, subType = "averaged_sum") + diff(actors$level, </span></span>
<span><span class="co">##     joining = -1, subType = "averaged_sum") + same(actors$gender, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion") + same(actors$group, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion") + tie(known.before, </span></span>
<span><span class="co">##     joining = -1, subType = "proportion") + size(networkInteractions, </span></span>
<span><span class="co">##     joining = -1, subType = "identity") + egopop(networkPast, </span></span>
<span><span class="co">##     joining = 1, subType = "normalized") + egopop(networkPast, </span></span>
<span><span class="co">##     joining = -1, subType = "normalized"), sub_model = "rate", </span></span>
<span><span class="co">##     data = rfidData, control_estimation = set_estimation_opt(engine = "default"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Effects details:</span></span>
<span><span class="co">##           Object                joining subType         </span></span>
<span><span class="co">## Intercept ""                    ""      ""              </span></span>
<span><span class="co">## intercept "networkInteractions" "1"     ""              </span></span>
<span><span class="co">## ego       "actors$age"          "1"     ""centered""    </span></span>
<span><span class="co">## ego       "actors$age"          "-1"    ""centered""    </span></span>
<span><span class="co">## diff      "actors$age"          "-1"    ""averaged_sum""</span></span>
<span><span class="co">## diff      "actors$level"        "-1"    ""averaged_sum""</span></span>
<span><span class="co">## same      "actors$gender"       "-1"    ""proportion""  </span></span>
<span><span class="co">## same      "actors$group"        "-1"    ""proportion""  </span></span>
<span><span class="co">## tie       "known.before"        "-1"    ""proportion""  </span></span>
<span><span class="co">## size      "networkInteractions" "-1"    ""identity""    </span></span>
<span><span class="co">## egopop    "networkPast"         "1"     ""normalized""  </span></span>
<span><span class="co">## egopop    "networkPast"         "-1"    ""normalized""  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##            Estimate Std. Error  z-value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## Intercept -6.376865   0.396152 -16.0970 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## intercept  2.942756   0.406082   7.2467  4.27e-13 ***</span></span>
<span><span class="co">## ego        0.067331   0.026053   2.5844  0.009755 ** </span></span>
<span><span class="co">## ego        0.012435   0.036750   0.3384  0.735094    </span></span>
<span><span class="co">## diff      -0.142109   0.076203  -1.8649  0.062200 .  </span></span>
<span><span class="co">## diff       0.248709   0.240336   1.0348  0.300744    </span></span>
<span><span class="co">## same       0.051020   0.263799   0.1934  0.846641    </span></span>
<span><span class="co">## same       0.172918   0.409717   0.4220  0.672994    </span></span>
<span><span class="co">## tie        0.145864   0.379845   0.3840  0.700971    </span></span>
<span><span class="co">## size       0.133780   0.073838   1.8118  0.070015 .  </span></span>
<span><span class="co">## egopop     0.068527   0.105430   0.6500  0.515708    </span></span>
<span><span class="co">## egopop     0.177403   0.131982   1.3441  0.178900    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Converged with max abs. score of 0.00053 </span></span>
<span><span class="co">##   Log-Likelihood: -1303.5</span></span>
<span><span class="co">##   AIC:  2631 </span></span>
<span><span class="co">##   AICc: 2632.4 </span></span>
<span><span class="co">##   BIC:  2672.4 </span></span>
<span><span class="co">##   model: "DyNAMi" subModel: "rate"</span></span></code></pre>
<p>and:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estChoiceM2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate_dynami</a></span><span class="op">(</span></span>
<span>  <span class="va">formulaChoiceM2</span>,</span>
<span>  sub_model <span class="op">=</span> <span class="st">"choice"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">rfidData</span>,</span>
<span>  control_preprocessing <span class="op">=</span></span>
<span>    <span class="fu"><a href="../reference/set_preprocessing_opt.html">set_preprocessing_opt</a></span><span class="op">(</span>opportunities_list <span class="op">=</span> <span class="va">opportunities</span><span class="op">)</span>,</span>
<span>  control_estimation <span class="op">=</span> <span class="fu"><a href="../reference/set_estimation_opt.html">set_estimation_opt</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estChoiceM2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## estimate_dynami(x = dependentEvents ~ diff(actors$age, subType = "averaged_sum") + </span></span>
<span><span class="co">##     diff(actors$level, subType = "averaged_sum") + same(actors$gender, </span></span>
<span><span class="co">##     subType = "proportion") + same(actors$group, subType = "proportion") + </span></span>
<span><span class="co">##     alter(actors$age, subType = "mean") + tie(known.before, subType = "proportion") + </span></span>
<span><span class="co">##     size(networkInteractions, subType = "identity") + alterpop(networkPast, </span></span>
<span><span class="co">##     subType = "mean_normalized") + inertia(networkPast, window = 60, </span></span>
<span><span class="co">##     subType = "mean") + inertia(networkPast, window = 300, subType = "mean"), </span></span>
<span><span class="co">##     sub_model = "choice", data = rfidData, control_estimation = set_estimation_opt(engine = "default"), </span></span>
<span><span class="co">##     control_preprocessing = set_preprocessing_opt(opportunities_list = opportunities))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Effects details:</span></span>
<span><span class="co">##          Object                window subType            </span></span>
<span><span class="co">## diff     "actors$age"          ""     ""averaged_sum""   </span></span>
<span><span class="co">## diff     "actors$level"        ""     ""averaged_sum""   </span></span>
<span><span class="co">## same     "actors$gender"       ""     ""proportion""     </span></span>
<span><span class="co">## same     "actors$group"        ""     ""proportion""     </span></span>
<span><span class="co">## alter    "actors$age"          ""     ""mean""           </span></span>
<span><span class="co">## tie      "known.before"        ""     ""proportion""     </span></span>
<span><span class="co">## size     "networkInteractions" ""     ""identity""       </span></span>
<span><span class="co">## alterpop "networkPast"         ""     ""mean_normalized""</span></span>
<span><span class="co">## inertia  "networkPast"         "60"   ""mean""           </span></span>
<span><span class="co">## inertia  "networkPast"         "300"  ""mean""           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##           Estimate Std. Error z-value Pr(&gt;|z|)   </span></span>
<span><span class="co">## diff     -0.133077   0.073387 -1.8134 0.069776 . </span></span>
<span><span class="co">## diff      0.095857   0.231054  0.4149 0.678238   </span></span>
<span><span class="co">## same      0.141033   0.321444  0.4387 0.660843   </span></span>
<span><span class="co">## same     -0.284446   0.418710 -0.6793 0.496924   </span></span>
<span><span class="co">## alter     0.033538   0.017678  1.8971 0.057809 . </span></span>
<span><span class="co">## tie       1.274992   0.393714  3.2384 0.001202 **</span></span>
<span><span class="co">## size      0.097754   0.093141  1.0495 0.293934   </span></span>
<span><span class="co">## alterpop  0.288526   0.170532  1.6919 0.090662 . </span></span>
<span><span class="co">## inertia   0.211654   0.458129  0.4620 0.644084   </span></span>
<span><span class="co">## inertia  -0.096613   0.235330 -0.4105 0.681410   </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Converged with max abs. score of 2e-05 </span></span>
<span><span class="co">##   Log-Likelihood: -189.76</span></span>
<span><span class="co">##   AIC:  399.53 </span></span>
<span><span class="co">##   AICc: 401.49 </span></span>
<span><span class="co">##   BIC:  427.65 </span></span>
<span><span class="co">##   model: "DyNAMi" subModel: "choice"</span></span></code></pre>
<p>Of course these models ask a bit much from our data, so ideally we
would a bit more reasonable with the number of effects we include, or do
some model selection.</p>
</div>
<div class="section level4">
<h4 id="step-6-extra-steps">Step 6: Extra steps<a class="anchor" aria-label="anchor" href="#step-6-extra-steps"></a>
</h4>
<p>We now have for each rate model a general intercept and a dummy
interaction between the intercept and the joining events. If we want to
report the actual intercept for joining, we can calculate the following
(for M2 for example):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">estRateM2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">estInterceptJoining</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">estRateM2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">estRateM2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">seInterceptJoining</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span></span>
<span>  <span class="va">covMatrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">covMatrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">covMatrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tInterceptJoining</span> <span class="op">&lt;-</span> <span class="va">estInterceptJoining</span> <span class="op">/</span> <span class="va">seInterceptJoining</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"Intercept for joining: %.3f (SE = %.3f, t = %.3f)"</span>,</span>
<span>  <span class="va">estInterceptJoining</span>, <span class="va">seInterceptJoining</span>, <span class="va">tInterceptJoining</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Intercept for joining: -3.434 (SE = 0.089, t = -38.477)"</span></span></code></pre>
<p>This script can be continued by looking at better model
specifications than the ones provided, or trying to model the
interaction data collected from RFID badges rather than video
recordings, and maybe compare both.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jameshollway.com" class="external-link">James Hollway</a>, <a href="https://sn.ethz.ch/profile.html?persid=210738" class="external-link">Christoph Stadtfeld</a>, Marion Hoffman, Alvaro Uzaheta.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
